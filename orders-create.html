<script>
const API_URL = "https://script.google.com/macros/s/AKfycbzrwM8NxpGcgTpX0UUoElfs94U-CGHnFiL7S2zWtkWwGq2p2GqAbRlPOWfnpEo7hBbHFw/exec";

function createOrder(){

  const formData = new URLSearchParams();
  formData.append("customer", customer.value);
  formData.append("product", product.value);
  formData.append("product_id", product_id.value);
  formData.append("qty", qty.value);
  formData.append("total", total.value);
  formData.append("paid", paid.value);
  formData.append("balance", total.value - paid.value);
  formData.append("company", localStorage.getItem("company"));
  formData.append("payment_mode", payment_mode.value);
  formData.append("created_by", localStorage.getItem("user"));

  fetch(API_URL, {
    method: "POST",
    body: formData
  })
  .then(res => res.json())
  .then(result => {
    if(result.success){
      alert("Order Created âœ…\nOrder ID: " + result.order_id);
      location.href = "orders.html";
    } else {
      alert("Server error: " + result.error);
    }
  })
  .catch(err => {
    console.error(err);
    alert("Network / API error");
  });
}
</script>
